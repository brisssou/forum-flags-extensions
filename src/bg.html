<html>
<head>
<script src="prefs.js"></script>
<script src="web.js"></script>
<script src="behaviour.js"></script>
<script type="text/javascript">

  var popupContent = new function() {
    this.entries: new Array();
    
    function add(title, href) {
      this.entries.push({title:title, href:href});
    },
    
    clear: function() {
      this.entries = new Array();
    }
    
  };

	function scheduleRequest() {
		window.setTimeout(startRequest, getPref(REFRESH_TIME_PREF) * 1000);
	}
	
	function startRequest() {
	  getUnreadCount(
		function(count) {
		  //loadingAnimation.stop();
		  updateBadge(count);
		  scheduleRequest();
		},
		function() {
		  //loadingAnimation.stop();
		  //showLoggedOut();
		  scheduleRequest();
		}
	  );
	}

  function initBG() {
    iconImage = document.getElementById('icon')
    canvas = document.getElementById('canvas');
    canvasContext = canvas.getContext('2d');
    chrome.browserAction.onClicked.addListener(goToHfr);
    //chrome.browserAction.onClicked.addListener(startRequest);
    initBrowserAction();
    startRequest();
  }
</script>
</head>
<body onload="initBG()">
  <img id="icon" src="icon.ico"/>
  <canvas id="canvas" width="19" height="19"></canvas>
</body>
</html>
